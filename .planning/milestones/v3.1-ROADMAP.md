# Milestone v3.1: Config Validation

**Status:** ✅ SHIPPED 2026-01-30
**Phases:** 15
**Total Plans:** 1

## Overview

Add input validation to settings screen: path existence and content checks for directory settings, numeric bounds for delay settings. All validation happens at config-edit time in the TUI settings flow with reject-and-reprompt behavior.

## Phases

### Phase 15: Config Validation

**Goal**: Settings reject invalid values at edit time — paths must exist and contain expected content, numeric values must be within bounds
**Depends on**: Phase 13 (config screen and settings persistence)
**Requirements**: PATH-01, PATH-02, PATH-03, PATH-04, PATH-05, PATH-06, PATH-07, NUM-01, NUM-02, NUM-03
**Success Criteria** (what must be TRUE):
  1. Changing klipper_dir to a non-existent path or one without `Makefile` is rejected with error message and re-prompt
  2. Changing katapult_dir to a non-existent path or one without `scripts/flashtool.py` is rejected with error message and re-prompt
  3. Changing config_cache_dir to a non-existent path is rejected with error message and re-prompt
  4. All path inputs have `~` expanded before validation
  5. stagger_delay rejects values outside 0–30s, return_delay rejects values outside 0–60s, both re-prompt on invalid
**Plans:** 1 plan

Plans:
- [x] 15-01-PLAN.md — Add validation functions and wire into settings edit flow

---

## Milestone Summary

**Key Decisions:**
- Decision: Late import of validators inside branches (Rationale: Consistent with existing lazy-import pattern in tui.py)

**Issues Resolved:**
- None — clean execution

**Issues Deferred:**
- Registry JSON integrity validation (deferred to future milestone)
- Device entry validation at add time (deferred to future milestone)

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
