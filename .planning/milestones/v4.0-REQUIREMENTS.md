# Requirements Archive: v4.0 Remove CLI & Internalize Device Keys

**Archived:** 2026-02-01
**Status:** SHIPPED

This is the archived requirements specification for v4.0.

---

## v4.0 Requirements

### CLI Removal

- [x] **CLI-01**: `kflash` launches directly into TUI menu with no argument parsing
- [x] **CLI-02**: Running `kflash --device X` or any old flag — ignored, TUI launches (unreleased tool)
- [x] **CLI-03**: All argparse setup, `_parse_args()`, and flag-driven command routing removed from flash.py
- [x] **CLI-04**: Late-import branches that only existed for CLI code paths removed

### Key Internalization

- [x] **KEY-01**: New devices get auto-generated slug key from display name (e.g., "Octopus Pro v1.1" to `octopus-pro-v1-1`)
- [x] **KEY-02**: Slug collision handling appends numeric suffix (`-2`, `-3`) when key already exists
- [x] **KEY-03**: Add-device wizard no longer prompts for device key — only display name
- [x] **KEY-04**: Device config screen removes key edit option and hides internal key entirely
- [x] **KEY-05**: All user-facing output shows `entry.name` instead of `entry.key`
- [x] **KEY-06**: Existing devices.json keys preserved as-is (no migration, no re-derivation)

### Documentation & Cleanup

- [x] **DOC-01**: README updated to remove CLI reference section, document TUI-only usage
- [x] **DOC-02**: CLAUDE.md updated to remove CLI commands section
- [x] **DOC-03**: Error/recovery messages updated to reference TUI actions instead of CLI flags
- [x] **DOC-04**: install.sh updated if needed (kflash symlink stays, just remove any flag references)

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| CLI-01 | Phase 26 | Complete |
| CLI-02 | Phase 26 | Complete |
| CLI-03 | Phase 26 | Complete |
| CLI-04 | Phase 26 | Complete |
| KEY-01 | Phase 24 | Complete |
| KEY-02 | Phase 24 | Complete |
| KEY-03 | Phase 25 | Complete |
| KEY-04 | Phase 25 | Complete |
| KEY-05 | Phase 25 | Complete |
| KEY-06 | Phase 25 | Complete |
| DOC-01 | Phase 27 | Complete |
| DOC-02 | Phase 27 | Complete |
| DOC-03 | Phase 27 | Complete |
| DOC-04 | Phase 27 | Complete |

## Milestone Summary

**Shipped:** 14 of 14 requirements
**Adjusted:** CLI-02 — migration message replaced with silent ignore (tool unreleased)
**Dropped:** None

---
*Archived: 2026-02-01 as part of v4.0 milestone completion*
