# Milestone v4.0: Remove CLI & Internalize Device Keys

**Status:** SHIPPED 2026-02-01
**Phases:** 24-27
**Total Plans:** 6

## Overview

Remove all CLI/argparse elements and make device keys auto-generated internal identifiers — the tool operates exclusively through TUI.

## Phases

### Phase 24: Slug Generation
**Goal**: New devices get filesystem-safe keys auto-derived from display names
**Depends on**: Phase 23
**Requirements**: KEY-01, KEY-02
**Success Criteria**:
  1. `generate_device_key()` converts "Octopus Pro v1.1" to `octopus-pro-v1-1`
  2. Collision handling with numeric suffix (`-2`, `-3`)
  3. Edge cases: empty rejection, 64-char truncation, path-traversal stripping
**Plans**: 1 plan

Plans:
- [x] 24-01: Add generate_device_key() to validation.py with slugification and collision handling

### Phase 25: Key Internalization in TUI
**Goal**: Device keys are invisible internal identifiers — users interact only with display names
**Depends on**: Phase 24
**Requirements**: KEY-03, KEY-04, KEY-05, KEY-06
**Success Criteria**:
  1. Add-device wizard prompts only for display name — key auto-generated
  2. Device config screen has no key edit option
  3. All user-facing output shows entry.name not entry.key
  4. Existing devices.json keys preserved as-is
**Plans**: 2 plans

Plans:
- [x] 25-01: Remove key prompt from add-device wizard, wire generate_device_key()
- [x] 25-02: Remove key edit from device config screen, replace entry.key with entry.name in all output

### Phase 26: Remove CLI
**Goal**: kflash launches directly into TUI with no argument parsing
**Depends on**: Phase 25
**Requirements**: CLI-01, CLI-02, CLI-03, CLI-04
**Success Criteria**:
  1. Running `kflash` on TTY launches TUI directly
  2. No argparse, build_parser(), or CLI-only code paths
  3. from_tui/from_menu params removed from all functions
  4. Error recovery text is TUI-only
**Plans**: 1 plan

Plans:
- [x] 26-01: Delete CLI infrastructure, rewrite main() as thin TUI launcher

### Phase 27: Documentation & Cleanup
**Goal**: All docs and error messages reflect TUI-only operation
**Depends on**: Phase 26
**Requirements**: DOC-01, DOC-02, DOC-03, DOC-04
**Success Criteria**:
  1. README documents TUI-only usage
  2. CLAUDE.md has TUI Menu section (no CLI Commands)
  3. Error recovery messages reference TUI actions
  4. install.sh says "Run kflash to start"
**Plans**: 2 plans

Plans:
- [x] 27-01: Update README, CLAUDE.md, install.sh for TUI-only operation
- [x] 27-02: Audit and update error templates and recovery messages in errors.py

---

## Milestone Summary

**Key Decisions:**
- Auto-generated slug keys from display names (no user prompt)
- Thin TUI launcher with TTY guard (no arg parsing at all)
- TUI action names in recovery text instead of key shortcuts

**Issues Resolved:**
- Obsolete comment in models.py referencing --device flag (fixed during audit)

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
