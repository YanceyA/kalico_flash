---
phase: 07-release-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can follow Quick Start and flash a device in under 5 minutes"
    - "User can find any CLI command in the reference table"
    - "User can copy-paste Moonraker Update Manager config"
    - "User knows how to uninstall"
  artifacts:
    - path: "README.md"
      provides: "Complete documentation for public release"
      min_lines: 200
      contains: "Quick Start"
  key_links:
    - from: "README.md"
      to: "install.sh"
      via: "Installation instructions"
      pattern: "./install.sh"
    - from: "README.md"
      to: "moonraker.conf"
      via: "Update Manager snippet"
      pattern: "update_manager kalico-flash"
---

<objective>
Rewrite README.md for public release with Quick Start, Features, CLI Reference, and Moonraker Update Manager integration.

Purpose: Enable new users to go from git clone to first flash quickly
Output: Complete README.md replacing the v1.0 development documentation
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-release-polish/07-CONTEXT.md
@.planning/phases/07-release-polish/07-RESEARCH.md
@README.md
@kalico-flash/flash.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite README.md for public release</name>
  <files>README.md</files>
  <action>
Replace the current README.md with a public-release version following this structure:

**1. Title and Description (brief)**
```markdown
# kalico-flash

One-command firmware building and flashing for Kalico/Klipper USB boards.
```

**2. Quick Start (numbered steps with expected output)**
Four steps: Clone, Install, Add device, Flash

```markdown
## Quick Start

1. **Clone the repository:**
   ```bash
   git clone https://github.com/USER/kalico-flash.git ~/kalico-flash
   cd ~/kalico-flash
   ```

2. **Install:**
   ```bash
   ./install.sh
   ```
   Expected: `Installed kflash -> /home/pi/kalico-flash/kalico-flash/flash.py`

3. **Add your first device:**
   ```bash
   kflash --add-device
   ```
   Follow the wizard to register a connected board.

4. **Flash:**
   ```bash
   kflash
   ```
   Select your device from the menu, or use `kflash -d DEVICE_KEY` directly.
```

**3. Features (with examples)**
- Interactive TUI menu (`kflash` with no args)
- Skip menuconfig (`kflash -d octopus-pro -s`)
- Device exclusion (Beacon probes, etc.)
- Print safety (blocks during active prints)
- Version display (shows host vs MCU versions)
- Post-flash verification (confirms device reappears)

Each feature: one sentence description + example command + brief expected behavior.

**4. CLI Reference (table format)**
Complete table of all commands:

| Command | Description | Example |
|---------|-------------|---------|
| `kflash` | Interactive menu | `kflash` |
| `kflash -d KEY` | Flash specific device | `kflash -d octopus-pro` |
| `kflash -d KEY -s` | Flash, skip menuconfig | `kflash -d octopus-pro -s` |
| `kflash --add-device` | Register new device | `kflash --add-device` |
| `kflash --list-devices` | Show registered devices | `kflash --list-devices` |
| `kflash --remove-device KEY` | Remove device | `kflash --remove-device old-board` |
| `kflash --exclude-device KEY` | Mark non-flashable | `kflash --exclude-device beacon` |
| `kflash --include-device KEY` | Mark flashable | `kflash --include-device beacon` |
| `kflash --version` | Show version | `kflash --version` |
| `kflash --help` | Show help | `kflash --help` |

**5. Installation (detailed)**
- Requirements section (Python 3.9+, Raspberry Pi, Klipper source, passwordless sudo)
- Step-by-step install with explanation of what install.sh does
- Note about symlink approach (git pull updates automatically)

**6. Moonraker Update Manager**
Copy-paste snippet with explanation:

```markdown
## Automatic Updates

Add to `moonraker.conf` for automatic updates through Fluidd/Mainsail:

```ini
[update_manager kalico-flash]
type: git_repo
path: ~/kalico-flash
origin: https://github.com/USER/kalico-flash.git
primary_branch: master
is_system_service: False
```

After adding, restart Moonraker: `sudo systemctl restart moonraker`
```

**7. Uninstall**
```markdown
## Uninstall

To remove kalico-flash:

```bash
./install.sh --uninstall
```

This removes the `kflash` command. The repository can then be deleted if desired.
```

**8. Requirements/Compatibility (brief)**
- Python 3.9+ (stdlib only)
- Raspberry Pi or similar Linux SBC
- Klipper/Kalico at ~/klipper
- USB-connected boards only (not CAN)
- Tested boards: BTT Octopus Pro, LDO Nitehawk

**Style notes:**
- Keep it concise - no walls of text
- Show actual commands with realistic output
- Use USER as GitHub username placeholder (user will replace)
- No troubleshooting section (per CONTEXT.md - inline errors are sufficient)
- No emojis
  </action>
  <verify>
Read through README.md and verify:
1. Quick Start has 4 numbered steps with commands
2. CLI Reference table has all 10 commands
3. Moonraker Update Manager snippet is present
4. Uninstall instructions are present
5. No troubleshooting section
  </verify>
  <done>
- README.md completely rewritten for public release
- Quick Start enables clone-to-flash in under 5 minutes
- All CLI commands documented with examples
- Moonraker Update Manager config provided
- Uninstall instructions included
  </done>
</task>

</tasks>

<verification>
1. README.md has Quick Start with 4 numbered steps
2. CLI Reference table covers all commands (kflash, -d, -s, --add-device, --list-devices, --remove-device, --exclude-device, --include-device, --version, --help)
3. Moonraker Update Manager snippet is copy-paste ready
4. Uninstall section references `./install.sh --uninstall`
5. No troubleshooting section (per CONTEXT.md decision)
6. Total README is 200+ lines with useful content (not padding)
</verification>

<success_criteria>
- DOC-01: README has clear installation instructions
- DOC-02: Quick start gets user from zero to first flash
- DOC-03: All CLI commands documented with examples
- DOC-04: Common errors have troubleshooting entries (satisfied by inline error messages per CONTEXT.md)
- DOC-05: Update and uninstall instructions included
- DOC-06: Moonraker Update Manager integration example
</success_criteria>

<output>
After completion, create `.planning/phases/07-release-polish/07-02-SUMMARY.md`
</output>
